<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Otto Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header id="header">
            <div class="header-left">
                <button id="sidebar-toggle" class="icon-btn" aria-label="Toggle sidebar">â˜°</button>
                <h1>Otto <span class="accent">Dashboard</span></h1>
            </div>
            <div class="header-right">
                <span id="connection-status" class="status-dot disconnected" title="Disconnected"></span>
                <span id="tunnel-status" class="tunnel-badge hidden" title="Tunnel URL"></span>
            </div>
        </header>

        <div id="main-layout">
            <!-- Sidebar -->
            <aside id="sidebar" class="open">
                <div class="sidebar-section">
                    <div class="sidebar-header">
                        <h2>Sessions</h2>
                        <button id="new-session-btn" class="icon-btn" title="New session">+</button>
                    </div>
                    <div id="session-list"></div>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-header">
                        <h2>Saved Sessions</h2>
                    </div>
                    <div id="persisted-session-list"></div>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-header">
                        <h2>Tunnel</h2>
                    </div>
                    <div id="tunnel-controls">
                        <div id="tunnel-info" class="tunnel-info">
                            <span class="tunnel-label">Status:</span>
                            <span id="tunnel-state">Not running</span>
                        </div>
                        <div id="tunnel-url-display" class="hidden">
                            <input id="tunnel-url-input" type="text" readonly>
                            <button id="copy-tunnel-url" class="small-btn">Copy</button>
                        </div>
                        <div class="tunnel-actions">
                            <button id="start-tunnel-btn" class="btn btn-sm">Start Tunnel</button>
                            <button id="stop-tunnel-btn" class="btn btn-sm btn-danger hidden">Stop Tunnel</button>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main content -->
            <main id="content">
                <!-- Empty state -->
                <div id="empty-state" class="empty-state">
                    <div class="empty-icon">ðŸš€</div>
                    <h2>No session selected</h2>
                    <p>Create a new session or select one from the sidebar to get started.</p>
                    <button class="btn btn-primary" onclick="showNewSessionDialog()">New Session</button>
                </div>

                <!-- Chat view (hidden by default) -->
                <div id="chat-view" class="hidden">
                    <div id="chat-header">
                        <div class="chat-session-info">
                            <h3 id="chat-session-name"></h3>
                            <span id="chat-session-model" class="model-badge"></span>
                            <span id="chat-session-status" class="status-badge"></span>
                        </div>
                        <div id="chat-activity" class="activity-indicator hidden">
                            <span class="activity-icon"></span>
                            <span class="activity-text"></span>
                        </div>
                        <button id="share-btn" class="btn btn-sm" title="Share this session (read-only, 1hr)">ðŸ”— Share</button>
                    </div>
                    <div id="chat-messages"></div>
                    <div id="chat-input-area">
                        <textarea id="chat-input" placeholder="Send a message..." rows="1"></textarea>
                        <button id="send-btn" class="btn btn-primary" disabled>Send</button>
                    </div>
                </div>
            </main>
        </div>

        <!-- New session dialog -->
        <div id="new-session-dialog" class="modal hidden">
            <div class="modal-backdrop" onclick="hideNewSessionDialog()"></div>
            <div class="modal-content">
                <h2>New Session</h2>
                <form id="new-session-form" onsubmit="return handleCreateSession(event)">
                    <div class="form-group">
                        <label for="session-name">Name</label>
                        <input id="session-name" type="text" required placeholder="my-session" autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="session-model">Model</label>
                        <select id="session-model">
                            <option value="claude-sonnet-4.5">Claude Sonnet 4.5</option>
                            <option value="claude-opus-4.6" selected>Claude Opus 4.6</option>
                            <option value="gpt-5.2">GPT-5.2</option>
                            <option value="gpt-5.2-codex">GPT-5.2-Codex</option>
                            <option value="gpt-5.1-codex">GPT-5.1-Codex</option>
                            <option value="gemini-3-pro-preview">Gemini 3 Pro</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="session-workdir">Working Directory</label>
                        <select id="session-workdir">
                            <option value="">Default (current directory)</option>
                        </select>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="btn" onclick="hideNewSessionDialog()">Cancel</button>
                        <button type="submit" class="btn btn-primary">Create</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script src="app.js"></script>
</body>
</html>
